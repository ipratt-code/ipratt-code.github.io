var sendJson=function(){console.log("not started")},crypt={secret:"admin",encrypt:function(e){var n=CryptoJS.AES.encrypt(e,crypt.secret);return n=n.toString()},decrypt:function(e){var n=CryptoJS.AES.decrypt(e,crypt.secret);return n=n.toString(CryptoJS.enc.Utf8)}};function launchApp(){var e=document.getElementById("name").value;0==e&&(e="Unnamed User");var n=document.getElementById("channel").value;0==n&&(n="main"),$(".channel-indicator").html("#"+n),$(".name-indicator").html(e),connect(e,n),$(".homepage").removeClass("visible"),$(".homepage").addClass("hidden"),$(".client").removeClass("hidden"),$(".client").addClass("visible")}function connect(e,n){var t=new WebSocket("wss://j24amtdvi4.execute-api.us-east-1.amazonaws.com/prod");sendJson=function(e){t.send(JSON.stringify(e))},t.onopen=function(){sendJson({route:"join",data:{id:n,team:"lt"}});setInterval(()=>{console.log("Keeping Nod alive..."),sendJson({route:"ping"})},54e4)},t.onmessage=function(e){console.log(e.data);var n=JSON.parse(e.data),t=clean(n.message.username),s=crypt.decrypt(clean(n.message.emoji));$(".messages").append(t+": "+s+"<br>"),$(".messages").scrollTop($(".messages").scrollHeight)},t.onclose=function(e){console.log("Socket is closed. Reconnect will be attempted in 1 second.",e.reason),setTimeout(function(){connect()},1e3)},t.onerror=function(e){console.error("Socket encountered error: ",e.message,"Closing socket"),t.close()}}function sendMessage(){if(0==document.getElementById("message-box").value.length)return!1;sendJson({action:"MESSAGE",message:{id:document.getElementById("channel").value,emoji:crypt.encrypt(document.getElementById("message-box").value),username:document.getElementById("name").value,img:"",tone:""}}),$(".messages").append("You: "+document.getElementById("message-box").value+"<br>"),$(".messages").scrollTop($(".messages").scrollHeight),document.getElementById("message-box").value=""}function clean(e){return e.replace(/[<>&'"]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;";case":":return"&#58;";case";":return"&#59;";case"{":return"&#123;";case"}":return"&#125;";case",":return"&#44;"}})}$(document).keyup(function(e){$(".name").is(":focus")&&"Enter"==e.key&&launchApp()}),$(document).keyup(function(e){$(".message-box").is(":focus")&&"Enter"==e.key&&sendMessage()});